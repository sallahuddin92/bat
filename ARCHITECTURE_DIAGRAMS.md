# ğŸ“Š Ubat Saya - System Architecture & Data Flow Diagrams

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER'S DEVICE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚          Web Browser (Chrome/Firefox/Safari)               â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚                                                             â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚   â”‚  â”‚         User Interface (HTML/Tailwind)          â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”Œâ”€ Patient Input Form                          â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Name field                               â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ IC/ID field                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ Medicine Selector                           â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ Dropdown (30+ medicines)                 â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ Dosage Scheduler                            â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ PAGI (8:00 AM)                           â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ TENGAH HARI (1:00 PM)                    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ PETANG (6:00 PM)                         â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ MALAM (10:00 PM)                         â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ JIKA PERLU (As needed)                   â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€ Chart Management Buttons                    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Save Chart                               â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Load Chart                               â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Export JSON                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Import JSON                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Generate PDF                             â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Clear Chart                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â””â”€ Manage Medicines (Admin)                 â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚   â”‚                      â†“ JavaScript                         â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚   â”‚  â”‚     Application Logic & State Management         â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ selectedMedicines[] (in memory)             â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ currentChartId (tracking)                   â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ isDataModified (flag)                       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ Chart CRUD functions                        â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ addMedicineToChart()                     â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ removeMedicine()                         â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ updateDosage()                           â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ saveChart()                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ restoreChart()                           â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ deleteChart()                            â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ exportChartAsJSON()                      â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ importChartFromJSON()                    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ PDF Generation                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ generatePDF() (using html2pdf.js)        â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€ UI Rendering                                â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â””â”€ renderChart(), updatePatientName(), etc. â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚   â”‚                      â†“ IndexedDB API                      â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚   â”‚  â”‚      Database Layer (Promisified IDB)           â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  Function: promisifyRequest(idbRequest)         â”‚     â”‚    â”‚
â”‚   â”‚  â”‚           â†“ Converts IDBRequest â†’ Promise       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚      Enables async/await syntax                 â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  Database Operations:                           â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ db.transaction("medicines", "readonly")     â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ db.transaction("charts", "readwrite")       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ objectStore.add(data)                       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ objectStore.put(data)                       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ objectStore.get(key)                        â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ objectStore.delete(key)                     â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ objectStore.getAll()                        â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€ index.getAll() for searching                â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚   â”‚                      â†“ IDB Storage                        â”‚    â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚   â”‚  â”‚    Browser's IndexedDB Database Storage          â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  Database: "UbatSayaDB" (Version 2)             â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ Object Store 1: "medicines"                 â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Primary Key: code                        â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Index: generic_name                      â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Index: brand_variants                    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ Data: 30+ medicine records               â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚     (4-8KB each = ~240KB total)              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”œâ”€ Object Store 2: "charts"                    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Primary Key: chartId (auto-increment)    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Index: patientName                       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â”œâ”€ Index: createdDate                       â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚  â””â”€ Data: User's saved charts                â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚     (4-6KB each, unlimited)                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â”‚                                              â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  â””â”€ Object Store 3: "settings"                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â”œâ”€ Primary Key: key                         â”‚     â”‚    â”‚
â”‚   â”‚  â”‚     â””â”€ Data: App preferences                    â”‚     â”‚    â”‚
â”‚   â”‚  â”‚        (< 1KB)                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  Total Capacity: 50MB - 1GB                     â”‚     â”‚    â”‚
â”‚   â”‚  â”‚  Current Usage: ~1-2MB (with 100 charts)        â”‚     â”‚    â”‚
â”‚   â”‚  â”‚                                                  â”‚     â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚   â”‚                                                             â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚          External Resources (CDN - First Load)             â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚  â”œâ”€ Tailwind CSS (cdn.tailwindcss.com)         [~10 KB]    â”‚    â”‚
â”‚   â”‚  â”œâ”€ html2pdf.js (cdnjs.cloudflare.com)         [~200 KB]   â”‚    â”‚
â”‚   â”‚  â””â”€ Lucide Icons (unpkg.com/lucide-react)      [~30 KB]    â”‚    â”‚
â”‚   â”‚                                                             â”‚    â”‚
â”‚   â”‚  Cached after first load â†’ Works offline                   â”‚    â”‚
â”‚   â”‚                                                             â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            COMPLETELY LOCAL
                    (No data leaves user's device)
```

---

## ğŸ“Š Data Storage Structure

### IndexedDB "UbatSayaDB" - Version 2

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            IndexedDB: "UbatSayaDB" (v2)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Object Store: "medicines"                       â”‚   â”‚
â”‚  â”‚   Purpose: Medication database                    â”‚   â”‚
â”‚  â”‚   Primary Key: code (string)                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Record 1]                                      â”‚   â”‚
â”‚  â”‚  {                                               â”‚   â”‚
â”‚  â”‚    code: "PARA500",                              â”‚   â”‚
â”‚  â”‚    generic_name: "Paracetamol 500mg",            â”‚   â”‚
â”‚  â”‚    brand_variants: '["Panadol", "Uphamol"]',     â”‚   â”‚
â”‚  â”‚    form: "Tablet",                               â”‚   â”‚
â”‚  â”‚    shape: "Round",                               â”‚   â”‚
â”‚  â”‚    color: "White",                               â”‚   â”‚
â”‚  â”‚    image: "data:image/svg+xml;base64,...",       â”‚   â”‚
â”‚  â”‚    instruction: "Take 1-2 every 4-6 hours..."   â”‚   â”‚
â”‚  â”‚  }                                               â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Record 2-30]                                   â”‚   â”‚
â”‚  â”‚  { ... more medicines ... }                      â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  Indices:                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ generic_name (unique: false)                 â”‚   â”‚
â”‚  â”‚  â””â”€ brand_variants (unique: false)               â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Object Store: "charts"                         â”‚   â”‚
â”‚  â”‚   Purpose: User's saved medicine schedules       â”‚   â”‚
â”‚  â”‚   Primary Key: chartId (auto-increment number)   â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Record 1]                                      â”‚   â”‚
â”‚  â”‚  {                                               â”‚   â”‚
â”‚  â”‚    chartId: 1,                                   â”‚   â”‚
â”‚  â”‚    patientName: "Ahmad bin Ismail",              â”‚   â”‚
â”‚  â”‚    patientId: "801010-10-5555",                  â”‚   â”‚
â”‚  â”‚    createdDate: "2025-11-13T10:30:00Z",          â”‚   â”‚
â”‚  â”‚    medicines: [                                  â”‚   â”‚
â”‚  â”‚      {                                           â”‚   â”‚
â”‚  â”‚        code: "PARA500",                          â”‚   â”‚
â”‚  â”‚        generic_name: "Paracetamol 500mg",        â”‚   â”‚
â”‚  â”‚        instruction: "Take 1-2...",               â”‚   â”‚
â”‚  â”‚        chartId: "1234567890",                    â”‚   â”‚
â”‚  â”‚        dosage: {                                 â”‚   â”‚
â”‚  â”‚          pagi: true,                             â”‚   â”‚
â”‚  â”‚          tengah_hari: false,                     â”‚   â”‚
â”‚  â”‚          petang: false,                          â”‚   â”‚
â”‚  â”‚          malam: true,                            â”‚   â”‚
â”‚  â”‚          jika_perlu: false                       â”‚   â”‚
â”‚  â”‚        }                                         â”‚   â”‚
â”‚  â”‚      },                                          â”‚   â”‚
â”‚  â”‚      { ... more medicines ... }                  â”‚   â”‚
â”‚  â”‚    ],                                            â”‚   â”‚
â”‚  â”‚    notes: ""                                     â”‚   â”‚
â”‚  â”‚  }                                               â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Record 2-N]                                    â”‚   â”‚
â”‚  â”‚  { ... more patient charts ... }                 â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  Indices:                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ patientName (unique: false)                  â”‚   â”‚
â”‚  â”‚  â””â”€ createdDate (unique: false)                  â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Object Store: "settings"                       â”‚   â”‚
â”‚  â”‚   Purpose: App preferences and metadata          â”‚   â”‚
â”‚  â”‚   Primary Key: key (string)                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Record 1]                                      â”‚   â”‚
â”‚  â”‚  {                                               â”‚   â”‚
â”‚  â”‚    key: "lastChartId",                           â”‚   â”‚
â”‚  â”‚    value: 1                                      â”‚   â”‚
â”‚  â”‚  }                                               â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Record 2]                                      â”‚   â”‚
â”‚  â”‚  {                                               â”‚   â”‚
â”‚  â”‚    key: "theme",                                 â”‚   â”‚
â”‚  â”‚    value: "light"                                â”‚   â”‚
â”‚  â”‚  }                                               â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  [Future records]                                â”‚   â”‚
â”‚  â”‚  { ... more settings ... }                       â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                           â”‚
â”‚  Total Capacity: 50MB - 1GB                             â”‚
â”‚  Current Usage: ~1-2MB (demo with 30 medicines)        â”‚
â”‚  Typical Usage: ~5-50MB (with 100-1000 charts)        â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow - Creating a Medicine Chart

```
USER INTERFACE
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User enters patient name: "Ahmad"      â”‚
â”‚  User enters ID: "801010-10-5555"       â”‚
â”‚  User clicks medicine dropdown          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
JAVASCRIPT APPLICATION LOGIC
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User selects: "Paracetamol 500mg"       â”‚
â”‚                                         â”‚
â”‚ handleSelectMedicine("PARA500")         â”‚
â”‚   â†“                                     â”‚
â”‚ addMedicineToChart("PARA500")           â”‚
â”‚   â†“                                     â”‚
â”‚ Query IndexedDB medicines store         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
DATABASE LAYER (IndexedDB)
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Transaction: READ ONLY on "medicines"   â”‚
â”‚ Query: medicines.get("PARA500")         â”‚
â”‚                                         â”‚
â”‚ Returns: {                              â”‚
â”‚   code: "PARA500",                      â”‚
â”‚   generic_name: "Paracetamol 500mg",    â”‚
â”‚   instruction: "Take 1-2 every 4-6...", â”‚
â”‚   image: "data:image/svg+xml;...",      â”‚
â”‚   ... other fields ...                  â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
JAVASCRIPT - CREATE INSTANCE
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create medicine instance with dosage:   â”‚
â”‚                                         â”‚
â”‚ {                                       â”‚
â”‚   code: "PARA500",                      â”‚
â”‚   generic_name: "Paracetamol 500mg",    â”‚
â”‚   chartId: "1234567890" (unique),       â”‚
â”‚   dosage: {                             â”‚
â”‚     pagi: false,                        â”‚
â”‚     tengah_hari: false,                 â”‚
â”‚     petang: false,                      â”‚
â”‚     malam: false,                       â”‚
â”‚     jika_perlu: false                   â”‚
â”‚   }                                     â”‚
â”‚ }                                       â”‚
â”‚                                         â”‚
â”‚ Add to selectedMedicines[] array        â”‚
â”‚ Set isDataModified = true               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
UI RENDERING
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ renderChart()                           â”‚
â”‚   â†“                                     â”‚
â”‚ Create HTML row for medicine:           â”‚
â”‚ â”œâ”€ Image                                â”‚
â”‚ â”œâ”€ Name: Paracetamol 500mg              â”‚
â”‚ â”œâ”€ Instruction                          â”‚
â”‚ â”œâ”€ Remove button                        â”‚
â”‚ â””â”€ 5 dosage checkboxes                  â”‚
â”‚    â”œâ”€ PAGI (8:00 AM)        â˜           â”‚
â”‚    â”œâ”€ TENGAH HARI (1:00 PM) â˜           â”‚
â”‚    â”œâ”€ PETANG (6:00 PM)      â˜           â”‚
â”‚    â”œâ”€ MALAM (10:00 PM)      â˜           â”‚
â”‚    â””â”€ JIKA PERLU (As needed)â˜           â”‚
â”‚                                         â”‚
â”‚ Update lucide icons                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
USER SEES
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Medicine appears in chart!              â”‚
â”‚ User can now:                           â”‚
â”‚ - Check boxes to set dosage times       â”‚
â”‚ - Add more medicines                    â”‚
â”‚ - Remove this medicine                  â”‚
â”‚ - Save the chart                        â”‚
â”‚ - Generate PDF                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¾ Data Flow - Saving a Chart

```
USER CLICKS "SAVE CHART" BUTTON
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ saveChart() function                    â”‚
â”‚                                         â”‚
â”‚ Validate:                               â”‚
â”‚ âœ“ Patient name exists?                  â”‚
â”‚ âœ“ Selected medicines exist?              â”‚
â”‚                                         â”‚
â”‚ If invalid â†’ Show error message         â”‚
â”‚ If valid â†’ Continue                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Build chartData object:                 â”‚
â”‚                                         â”‚
â”‚ {                                       â”‚
â”‚   patientName: "Ahmad bin Ismail",      â”‚
â”‚   patientId: "801010-10-5555",          â”‚
â”‚   medicines: selectedMedicines[],       â”‚
â”‚   createdDate: ISO8601 timestamp,       â”‚
â”‚   notes: ""                             â”‚
â”‚ }                                       â”‚
â”‚                                         â”‚
â”‚ Example:                                â”‚
â”‚ {                                       â”‚
â”‚   patientName: "Ahmad bin Ismail",      â”‚
â”‚   patientId: "801010-10-5555",          â”‚
â”‚   medicines: [                          â”‚
â”‚     {                                   â”‚
â”‚       code: "PARA500",                  â”‚
â”‚       generic_name: "Paracetamol...",   â”‚
â”‚       chartId: "1234567890",            â”‚
â”‚       dosage: {                         â”‚
â”‚         pagi: true,                     â”‚
â”‚         malam: true,                    â”‚
â”‚         ... others false ...            â”‚
â”‚       }                                 â”‚
â”‚     },                                  â”‚
â”‚     { ... more medicines ... }          â”‚
â”‚   ],                                    â”‚
â”‚   createdDate: "2025-11-13T10:30:00Z"   â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
INDEXEDDB TRANSACTION
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ db.transaction("charts", "readwrite")   â”‚
â”‚   â†“                                     â”‚
â”‚ chartsStore.add(chartData)              â”‚
â”‚   â†“ (returns generated chartId = 1)     â”‚
â”‚   â†“                                     â”‚
â”‚ Transaction commits                     â”‚
â”‚                                         â”‚
â”‚ Result: Data written to disk            â”‚
â”‚ currentChartId = 1                      â”‚
â”‚ isDataModified = false                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
UI FEEDBACK
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show success modal:                     â”‚
â”‚ "âœ“ Saved"                               â”‚
â”‚ "Chart saved for Ahmad bin Ismail"      â”‚
â”‚                                         â”‚
â”‚ Log: "Chart saved with ID: 1"           â”‚
â”‚                                         â”‚
â”‚ Data is now persistent!                 â”‚
â”‚ âœ“ Survives browser restart              â”‚
â”‚ âœ“ Survives device restart               â”‚
â”‚ âœ“ Survives browser update               â”‚
â”‚ âœ“ Can be exported/backed up             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¥ Data Flow - Exporting Chart as JSON

```
USER CLICKS "EXPORT" BUTTON
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ exportChartAsJSON() function            â”‚
â”‚                                         â”‚
â”‚ Check: Any data to export?              â”‚
â”‚ âœ“ selectedMedicines.length > 0?         â”‚
â”‚                                         â”‚
â”‚ If empty â†’ Show message                 â”‚
â”‚ If valid â†’ Continue                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create export object:                   â”‚
â”‚                                         â”‚
â”‚ chartData = {                           â”‚
â”‚   patientName: "Ahmad bin Ismail",      â”‚
â”‚   patientId: "801010-10-5555",          â”‚
â”‚   medicines: selectedMedicines[],       â”‚
â”‚   exportDate: "2025-11-13T10:30:00Z"    â”‚
â”‚ }                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Serialize to JSON string:               â”‚
â”‚                                         â”‚
â”‚ JSON.stringify(chartData, null, 2)      â”‚
â”‚                                         â”‚
â”‚ Result: Pretty-printed JSON             â”‚
â”‚ (newlines and indentation for          â”‚
â”‚  human readability)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Blob & download file:            â”‚
â”‚                                         â”‚
â”‚ Blob([jsonString])                      â”‚
â”‚   â†“                                     â”‚
â”‚ URL.createObjectURL(blob)               â”‚
â”‚   â†“                                     â”‚
â”‚ Create <a> element                      â”‚
â”‚   â†“                                     â”‚
â”‚ Set href to blob URL                    â”‚
â”‚ Set download filename                   â”‚
â”‚   â†“                                     â”‚
â”‚ Filename format:                        â”‚
â”‚ "Chart_Ahmad_bin_Ismail_2025-11-13.    â”‚
â”‚  json"                                  â”‚
â”‚   â†“                                     â”‚
â”‚ Trigger click() to download             â”‚
â”‚   â†“                                     â”‚
â”‚ Revoke blob URL                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
FILE SAVED TO DEVICE
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Download complete!                      â”‚
â”‚ File location (depends on browser):     â”‚
â”‚ - Chrome: ~/Downloads/                  â”‚
â”‚ - Firefox: ~/Downloads/                 â”‚
â”‚ - Safari: ~/Downloads/                  â”‚
â”‚                                         â”‚
â”‚ User now has:                           â”‚
â”‚ âœ“ Backup copy                           â”‚
â”‚ âœ“ Portable file (can email/upload)      â”‚
â”‚ âœ“ Shareable with colleagues             â”‚
â”‚ âœ“ Can import to another device          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ PDF Generation Flow

```
USER CLICKS "GENERATE PDF" BUTTON
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ generatePDF() function                  â”‚
â”‚                                         â”‚
â”‚ Validate:                               â”‚
â”‚ âœ“ Patient name exists?                  â”‚
â”‚                                         â”‚
â”‚ If invalid â†’ Show error                 â”‚
â”‚ If valid â†’ Continue                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show loading modal:                     â”‚
â”‚ "Generating PDF..."                     â”‚
â”‚ (disable button)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
HTML2PDF.JS INTEGRATION
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ html2pdf().from(element)                â”‚
â”‚ .set(options)                           â”‚
â”‚ .save()                                 â”‚
â”‚                                         â”‚
â”‚ Step 1: Clone the DOM                   â”‚
â”‚ â”œâ”€ onclone callback triggered           â”‚
â”‚ â””â”€ Sync checkbox states to clone        â”‚
â”‚                                         â”‚
â”‚ Step 2: Render with html2canvas         â”‚
â”‚ â”œâ”€ Convert HTML to canvas               â”‚
â”‚ â”œâ”€ Scale: 2x (high quality)             â”‚
â”‚ â”œâ”€ Format: JPEG quality 0.98            â”‚
â”‚ â””â”€ Rendering engines handle images      â”‚
â”‚                                         â”‚
â”‚ Step 3: Generate with jsPDF             â”‚
â”‚ â”œâ”€ Create PDF pages                     â”‚
â”‚ â”œâ”€ Format: A4 Portrait                  â”‚
â”‚ â”œâ”€ Unit: Inches                         â”‚
â”‚ â”œâ”€ Margin: 0.5 inches                   â”‚
â”‚ â””â”€ Add canvas images to pages           â”‚
â”‚                                         â”‚
â”‚ Step 4: Download                        â”‚
â”‚ â”œâ”€ Filename:                            â”‚
â”‚ â”‚  "Ubat_Saya_Ahmad_bin_Ismail.pdf"     â”‚
â”‚ â””â”€ Trigger browser download             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hide loading modal                      â”‚
â”‚ Re-enable button                        â”‚
â”‚ Show success notification               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
USER GETS PDF FILE
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PDF content includes:                   â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ UBAT SAYA (MY MEDICINES)            â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚ Patient: Ahmad bin Ismail           â”‚ â”‚
â”‚ â”‚ IC: 801010-10-5555                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Medicine Schedule                   â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚      â”‚Pagi  â”‚T.Hariâ”‚Petangâ”‚Malamâ”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚Paraceá¨â”‚  â˜‘   â”‚      â”‚      â”‚  â˜‘  â”‚ â”‚
â”‚ â”‚tomol  â”‚      â”‚      â”‚      â”‚     â”‚ â”‚
â”‚ â”‚       â”‚Take 1â”‚      â”‚      â”‚     â”‚ â”‚
â”‚ â”‚       â”‚when  â”‚      â”‚      â”‚     â”‚ â”‚
â”‚ â”‚       â”‚pain  â”‚      â”‚      â”‚     â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚Amlodi-â”‚  â˜‘   â”‚      â”‚      â”‚  â˜‘  â”‚ â”‚
â”‚ â”‚pine   â”‚      â”‚      â”‚      â”‚     â”‚ â”‚
â”‚ â”‚       â”‚Take  â”‚      â”‚      â”‚Once â”‚ â”‚
â”‚ â”‚       â”‚daily â”‚      â”‚      â”‚nightly
â”‚ â”‚       â”‚      â”‚      â”‚      â”‚     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ User can:                               â”‚
â”‚ âœ“ Print to paper                        â”‚
â”‚ âœ“ Save as PDF copy                      â”‚
â”‚ âœ“ Email to patient                      â”‚
â”‚ âœ“ Post on clinic wall                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Complete User Journey

```
Start
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. OPEN APP                          â”‚
â”‚    â””â”€ ubat.html in browser           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ENTER PATIENT INFO                â”‚
â”‚    â”œâ”€ Name                           â”‚
â”‚    â””â”€ IC/ID                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. SELECT MEDICINES                  â”‚
â”‚    â”œâ”€ Click dropdown                 â”‚
â”‚    â”œâ”€ Choose from 30+ items          â”‚
â”‚    â””â”€ Repeat for each medicine       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. SET DOSAGE SCHEDULE               â”‚
â”‚    â”œâ”€ Check boxes for PAGI            â”‚
â”‚    â”œâ”€ Check boxes for TENGAH HARI     â”‚
â”‚    â”œâ”€ Check boxes for PETANG          â”‚
â”‚    â”œâ”€ Check boxes for MALAM           â”‚
â”‚    â””â”€ Check boxes for JIKA PERLU      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. SAVE CHART (optional)             â”‚
â”‚    â”œâ”€ Data stored in IndexedDB       â”‚
â”‚    â”œâ”€ Survives browser restart       â”‚
â”‚    â””â”€ Can be loaded later            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. GENERATE PDF                      â”‚
â”‚    â”œâ”€ Professional layout            â”‚
â”‚    â”œâ”€ Includes patient info          â”‚
â”‚    â”œâ”€ Shows checked dosages          â”‚
â”‚    â””â”€ Ready to print                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. USE PDF                           â”‚
â”‚    â”œâ”€ Print for patient              â”‚
â”‚    â”œâ”€ Email to colleague             â”‚
â”‚    â”œâ”€ Save as digital record         â”‚
â”‚    â””â”€ Post on clinic bulletin        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. OPTIONAL: EXPORT BACKUP           â”‚
â”‚    â”œâ”€ Export as JSON                 â”‚
â”‚    â”œâ”€ Save to cloud/email            â”‚
â”‚    â””â”€ Backup complete!               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†“
Done! âœ“
```

---

## ğŸ“ˆ Scalability Matrix

```
                    Small Clinic    |  Medium Clinic  |  Large Hospital
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Medicines            30-50          |  50-100         |  100-200
Charts/Month         10-50          |  50-200         |  500-1000
Years of Data        1-2            |  2-5            |  5+ years
Estimated Size       ~5-10MB        |  ~20-50MB       |  ~100-500MB
Scalability          âœ… Excellent   |  âœ… Good        |  âš ï¸ Consider server
Recommended Setup    Local file     |  Web server     |  SQL database
Storage Limit Hit    Unlikely       |  Possible       |  Likely
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

**Database Diagrams**: Version 2.0  
**Created**: November 13, 2025  
**Status**: Complete âœ…

These diagrams visualize the complete system architecture, data structures, and information flows in the Ubat Saya application.
